<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Preference Analysis Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card {
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .genre-tag {
            display: inline-block;
            padding: 0.3em 0.6em;
            border-radius: 50px;
            margin-right: 0.5em;
            margin-bottom: 0.5em;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-bold text-indigo-700 mb-2">Music Preference Analytics</h1>
            <p class="text-lg text-gray-600">Interactive dashboard analyzing listener demographics and genre preferences</p>
        </header>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="card bg-white rounded-xl shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Total Respondents</h3>
                <div class="text-3xl font-bold text-indigo-600" id="totalRespondents">1,250</div>
                <p class="text-sm text-gray-500 mt-2">From diverse age groups</p>
            </div>
            <div class="card bg-white rounded-xl shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Top Genre</h3>
                <div class="text-3xl font-bold text-indigo-600" id="topGenre">Pop</div>
                <p class="text-sm text-gray-500 mt-2">32% of listeners</p>
            </div>
            <div class="card bg-white rounded-xl shadow-md p-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Average Age</h3>
                <div class="text-3xl font-bold text-indigo-600" id="avgAge">28.4</div>
                <p class="text-sm text-gray-500 mt-2">Years old</p>
            </div>
        </div>

        <!-- Visualization Section -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-10">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Genre Distribution</h2>
                <div class="flex space-x-2">
                    <button onclick="changeView('byGender')" class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-md">By Gender</button>
                    <button onclick="changeView('byAge')" class="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-md">By Age Group</button>
                    <button onclick="changeView('overall')" class="px-4 py-2 bg-indigo-600 text-white rounded-md">Overall</button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2">
                    <canvas id="genreChart"></canvas>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Genre Tags</h3>
                    <div id="genreTags" class="flex flex-wrap">
                        <!-- Tags will be generated by JavaScript -->
                    </div>
                    
                    <h3 class="text-lg font-semibold mt-6 mb-4">Demographic Insights</h3>
                    <div id="insights" class="space-y-3">
                        <!-- Insights will be generated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Age Distribution -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-10">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Age Distribution by Genre</h2>
            <canvas id="ageChart"></canvas>
        </div>

        <!-- Gender Distribution -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-10">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Gender Distribution</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <canvas id="genderChart"></canvas>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Genre Preferences by Gender</h3>
                    <canvas id="genderGenreChart"></canvas>
                </div>
            </div>
        </div>

        <!-- SQL Query Section -->
        <div class="bg-white rounded-xl shadow-md p-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">SQL Queries Behind the Data</h2>
            
            <div class="mb-6">
                <button onclick="toggleTab('query1')" class="px-4 py-2 bg-indigo-600 text-white rounded-t-md">Overall Genre Popularity</button>
                <button onclick="toggleTab('query2')" class="px-4 py-2 bg-indigo-100 text-indigo-700">Genre by Age</button>
                <button onclick="toggleTab('query3')" class="px-4 py-2 bg-indigo-100 text-indigo-700">Genre by Gender</button>
            </div>
            
            <div id="query1" class="tab-content bg-gray-50 p-4 rounded-b-md rounded-tr-md active">
                <pre class="bg-gray-800 text-green-400 p-4 rounded-md overflow-x-auto">
SELECT Favorite Music Genre AS Genre,
    count(*) AS NumPeople,
    Round((COUNT()*100.0)/(SELECT COUNT() FROM music_preferences_dataset), 2) AS Percentage
FROM music_preferences_dataset
GROUP BY Favorite Music Genre
ORDER BY Percentage DESC;</pre>
                <p class="mt-3 text-gray-600">Calculates the percentage distribution of music genres across all respondents.</p>
            </div>
            
            <div id="query2" class="tab-content bg-gray-50 p-4 rounded-b-md rounded-tr-md">
                <pre class="bg-gray-800 text-green-400 p-4 rounded-md overflow-x-auto">
SELECT 
    Favorite Music Genre AS Genre,
    Age AS Age,
    COUNT(*) AS Listeners,
    ROUND(100.0 * COUNT() / SUM(COUNT()) OVER (PARTITION BY age), 2) AS genre_percent
FROM music_preferences_dataset
GROUP BY age, Favorite Music Genre
ORDER BY age, genre_percent DESC;</pre>
                <p class="mt-3 text-gray-600">Shows genre preferences broken down by age groups with percentage distribution.</p>
            </div>
            
            <div id="query3" class="tab-content bg-gray-50 p-4 rounded-b-md rounded-tr-md">
                <pre class="bg-gray-800 text-green-400 p-4 rounded-md overflow-x-auto">
SELECT 
    Favorite Music Genre AS Genre,
    Gender AS Gender,
    COUNT(*) AS genre_count,
    ROUND(100.0 * COUNT() / SUM(COUNT()) OVER (PARTITION BY Gender), 2) AS genre_percent
FROM music_preferences_dataset
GROUP BY Gender, Favorite Music Genre
ORDER BY Gender, genre_percent DESC;</pre>
                <p class="mt-3 text-gray-600">Analyzes genre preferences by gender with percentage distribution.</p>
            </div>
        </div>
    </div>

    <script>
        // Sample data (in a real app, this would come from your SQL queries)
        const data = {
            genres: ['Pop', 'Rock', 'Hip Hop', 'Jazz', 'Electronic', 'Classical', 'Country', 'R&B'],
            percentages: [32, 22, 18, 12, 8, 5, 2, 1],
            byGender: {
                male: {
                    Pop: 28,
                    Rock: 30,
                    HipHop: 22,
                    Jazz: 8,
                    Electronic: 6,
                    Classical: 4,
                    Country: 1,
                    RB: 1
                },
                female: {
                    Pop: 36,
                    Rock: 15,
                    HipHop: 14,
                    Jazz: 16,
                    Electronic: 10,
                    Classical: 6,
                    Country: 2,
                    RB: 1
                },
                other: {
                    Pop: 30,
                    Rock: 20,
                    HipHop: 15,
                    Jazz: 15,
                    Electronic: 12,
                    Classical: 5,
                    Country: 2,
                    RB: 1
                }
            },
            byAge: {
                '10-19': { Pop: 45, Rock: 15, HipHop: 30, Jazz: 5, Electronic: 5 },
                '20-29': { Pop: 35, Rock: 20, HipHop: 25, Jazz: 10, Electronic: 10 },
                '30-39': { Pop: 25, Rock: 30, HipHop: 15, Jazz: 15, Electronic: 10, Classical: 5 },
                '40+': { Pop: 20, Rock: 25, HipHop: 10, Jazz: 20, Classical: 20, Country: 5 }
            }
        };

        // Colors for charts
        const genreColors = [
            '#6366F1', '#8B5CF6', '#EC4899', '#F43F5E', 
            '#F97316', '#F59E0B', '#10B981', '#14B8A6'
        ];

        // Initialize genre distribution chart
        const genreCtx = document.getElementById('genreChart').getContext('2d');
        const genreChart = new Chart(genreCtx, {
            type: 'doughnut',
            data: {
                labels: data.genres,
                datasets: [{
                    data: data.percentages,
                    backgroundColor: genreColors,
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return ${context.label}: ${context.raw}%;
                            }
                        }
                    }
                }
            }
        });

        // Initialize age distribution chart
        const ageCtx = document.getElementById('ageChart').getContext('2d');
        const ageChart = new Chart(ageCtx, {
            type: 'bar',
            data: {
                labels: ['10-19', '20-29', '30-39', '40+'],
                datasets: data.genres.map((genre, i) => ({
                    label: genre,
                    data: Object.values(data.byAge).map(group => group[genre.replace(' ', '')] || 0),
                    backgroundColor: genreColors[i],
                    borderWidth: 1
                }))
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                    },
                    y: {
                        stacked: true,
                        beginAtZero: true,
                        max: 100
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return ${context.dataset.label}: ${context.raw}%;
                            }
                        }
                    }
                }
            }
        });

        // Initialize gender distribution chart
        const genderCtx = document.getElementById('genderChart').getContext('2d');
        const genderChart = new Chart(genderCtx, {
            type: 'pie',
            data: {
                labels: ['Male', 'Female', 'Other'],
                datasets: [{
                    data: [45, 50, 5],
                    backgroundColor: ['#3B82F6', '#EC4899', '#10B981'],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return ${context.label}: ${context.raw}%;
                            }
                        }
                    }
                }
            }
        });

        // Initialize genre by gender chart
        const genderGenreCtx = document.getElementById('genderGenreChart').getContext('2d');
        const genderGenreChart = new Chart(genderGenreCtx, {
            type: 'bar',
            data: {
                labels: ['Pop', 'Rock', 'Hip Hop', 'Jazz'],
                datasets: [
                    {
                        label: 'Male',
                        data: [28, 30, 22, 8],
                        backgroundColor: '#3B82F6'
                    },
                    {
                        label: 'Female',
                        data: [36, 15, 14, 16],
                        backgroundColor: '#EC4899'
                    },
                    {
                        label: 'Other',
                        data: [30, 20, 15, 15],
                        backgroundColor: '#10B981'
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 40
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return ${context.dataset.label}: ${context.raw}%;
                            }
                        }
                    }
                }
            }
        });

        // Generate genre tags
        function generateGenreTags() {
            const container = document.getElementById('genreTags');
            container.innerHTML = '';
            data.genres.forEach((genre, i) => {
                const tag = document.createElement('span');
                tag.className = 'genre-tag';
                tag.style.backgroundColor = ${genreColors[i]}20;
                tag.style.color = genreColors[i];
                tag.textContent = genre;
                container.appendChild(tag);
            });
        }

        // Generate insights
        function generateInsights() {
            const container = document.getElementById('insights');
            container.innerHTML = `
                <div class="p-3 bg-indigo-50 rounded-md">
                    <p class="font-medium">🎵 Pop dominates across all age groups</p>
                    <p class="text-sm text-gray-600 mt-1">Peaks among 10-19 year olds (45%)</p>
                </div>
                <div class="p-3 bg-indigo-50 rounded-md">
                    <p class="font-medium">🎸 Rock is more popular with males (30%) than females (15%)</p>
                    <p class="text-sm text-gray-600 mt-1">Preferred by older listeners</p>
                </div>
                <div class="p-3 bg-indigo-50 rounded-md">
                    <p class="font-medium">🎶 Jazz has nearly equal gender distribution</p>
                    <p class="text-sm text-gray-600 mt-1">Grows in popularity with age</p>
                </div>
            `;
        }

        // Change view between overall, by gender, and by age
        function changeView(viewType) {
            // Reset all buttons
            document.querySelectorAll('[onclick^="changeView"]').forEach(btn => {
                btn.classList.remove('bg-indigo-600', 'text-white');
                btn.classList.add('bg-indigo-100', 'text-indigo-700');
            });
            
            // Highlight active button
            event.target.classList.add('bg-indigo-600', 'text-white');
            event.target.classList.remove('bg-indigo-100', 'text-indigo-700');
            
            // Update charts based on view type
            if (viewType === 'overall') {
                genreChart.data.datasets[0].data = data.percentages;
                genreChart.update();
                document.querySelector('#totalRespondents').textContent = '1,250';
                document.querySelector('#topGenre').textContent = 'Pop';
                document.querySelector('#avgAge').textContent = '28.4';
            } else if (viewType === 'byGender') {
                // For demo purposes, just updating numbers - in a real app, we'd update charts
                document.querySelector('#totalRespondents').textContent = '45% Male, 50% Female, 5% Other';
                document.querySelector('#topGenre').textContent = 'Pop (Female)';
                document.querySelector('#avgAge').textContent = 'Varies';
            } else if (viewType === 'byAge') {
                document.querySelector('#totalRespondents').textContent = 'By Age Groups';
                document.querySelector('#topGenre').textContent = 'Pop (10-19)';
                document.querySelector('#avgAge').textContent = 'Trending Younger';
            }
        }

        // Toggle SQL query tabs
        function toggleTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            
            // Update button styles
            document.querySelectorAll('[onclick^="toggleTab"]').forEach(btn => {
                btn.classList.remove('bg-indigo-600', 'text-white');
                btn.classList.add('bg-indigo-100', 'text-indigo-700');
            });
            
            event.target.classList.add('bg-indigo-600', 'text-white');
            event.target.classList.remove('bg-indigo-100', 'text-indigo-700');
        }

        // Initialize on load
        window.onload = function() {
            generateGenreTags();
            generateInsights();
        };
    </script>
</body>
</html>
